<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" media="screen" href="/static/stylesheets/quizbuilder.css"/>
<script type="text/javascript" src="/static/scripts/jquery/jquery-1.2.6.min.js"></script>
<script type="text/javascript" src="/static/scripts/json2min.js"></script>
<script type="text/javascript" src="/static/scripts/parseJSON.js"></script>
<script type="text/javascript" src="/static/scripts/jquery/jquery.field.min.js"></script>
<script type="text/javascript" src="/static/scripts/jquery/jquery.field.min.js"></script>
<!-- markItUp! -->
<script type="text/javascript" src="/static/scripts/markitup/jquery.markitup.pack.js"></script>
<!-- markItUp! toolbar settings -->
<script type="text/javascript" src="/static/scripts/markitup/sets/default/set.js"></script>
<!-- markItUp! skin -->

<link rel="stylesheet" type="text/css" href="/static/scripts/markitup/skins/markitup/style.css" />
<!--  markItUp! toolbar skin -->
<link rel="stylesheet" type="text/css" href="/static/scripts/markitup/sets/default/style.css" />

<script type="text/javascript" src="/static/scripts/quizbuilder/edit_quiz.js"></script>

<!-- freebase -->
<script type="text/javascript" src="/static/scripts/freebase-suggest/dist/freebase.suggest.js"></script> 
 <link type="text/css" rel="stylesheet" href="/static/scripts/freebase-suggest/dist/css/freebase-controls.css" />
 

<script type="text/javascript">




jQuery(function($) {


wrong_answers = [];
answer_in_array = [];



////////////////////////////////////////////////////////////////////////////////////////////

   jQuery.fn.extend({
	preserveDefaultText: function(defaultValue, replaceValue)
	{
		$(this).focus(function()
		{
			if(typeof(replaceValue) == 'undefined')
				replaceValue = '';  
			if($(this).val() == defaultValue)
				$(this).val(replaceValue);
		});

		$(this).blur(function(){  
			if(typeof(replaceValue) == 'undefined')
				replaceValue = '';  
			if($(this).val() == replaceValue)
				$(this).val(defaultValue);
		});
		return this;
	}
});


//$('.topic_name').preserveDefaultText('topic');
$('.url_name').preserveDefaultText('url');






    
function Request(function_name, opt_argv) {

	if (!opt_argv)
		opt_argv = new Array();

	// Find if the last arg is a callback function; save it
	var callback = null;
	var len = opt_argv.length;

	if (len > 0 && typeof opt_argv[len-1] == 'function') {
		callback = opt_argv[len-1];
		opt_argv.length--;
	}

	var async = (callback != null);

	// Encode the arguments in to a URI
	var query = 'action=' + encodeURIComponent(function_name);

	for (var i = 0; i < opt_argv.length; i++) {
		var key = 'arg' + i;
		var val = JSON.stringify(opt_argv[i]);
		query += '&' + key + '=' + encodeURIComponent(val);
	}
	query += '&time=' + new Date().getTime(); // IE cache workaround

	// Create an XMLHttpRequest 'GET' request w/ an optional callback handler 
	var req = new XMLHttpRequest();
	req.open('GET', '/quizbuilder/rpc?' + query, async);

	if (async) {
		req.onreadystatechange = function() {
			if(req.readyState == 4 && req.status == 200) {
				var response = null;
				try {
					response = JSON.parse(req.responseText);
				} catch (e) {
					response = req.responseText;
				}
				callback(response);
			}
		}
	}

	// Make the actual request
	req.send(null);
}

// Adds a stub function that will pass the arguments to the AJAX call 
function InstallFunction(obj, functionName) {
	obj[functionName] = function() { 
		Request(functionName, arguments);
	}
}


// Server object that will contain the callable methods
var server = {};
var item_count = 0;

InstallFunction(server, 'SubmitContentUrl');

InstallFunction(server, 'SubmitQuizItem');

function OnSubmitUrlSuccess(response){

$('form#content_url').hide();
var raw_quiz_items = parseJSON(response);


 $.each(raw_quiz_items, function(i,item){
 	
 	
$('.slug_name').preserveDefaultText('slug_name');
$('.category_name').preserveDefaultText('category');


 	
var html = '<div class="quiz_item"  id="' + i + '" ></div>';





html += '<div class="quiz_item_content" id="quiz_item_content_' + i + '">'; // start quiz item content

html += '<div class="pre_content">' + item.pre_content + '</div>';

html += '<div class="content" >' + item.content + '</div>';

html += '<div class="post_content">' + item.post_content + '</div>';


html += '</div>'; //end quiz item content



html += '<div class="index">' + item.index + '</div>';


html += '<div class="quiz_form"><form id="quiz_data_' + i + '" name="quiz_data_' + i + '"><input type="text" name="slug" class="slug_name" value="slug_name" /><br/><input type="text" name="category" class="category_name" value="category" /><br/><input type="submit" onClick="return false;this.disabled = true;" id="submit_item_' + i + '" class="submit_item" value="Submit Quiz Item" /></form></div>';


html += '<div class="answer_candidates" id="answers_' + i + '"></div>';  // Expand answer candidates







$('div#quiz_items').append(html);

console.log(item.answer_candidates);

answers =  eval(item.answer_candidates); //item.answer_candidates


console.log(answers);

 $.each(answers, function(n, answer){
 	
 	

answer_html = '<div id ="' + n + '" class="answer_candidate" >' + answer + '</div>';


$('div#answers_' + i).append(answer_html);

});


EditQuizItem(i, item, answers); // Run function after the above code is evaluated.

});





}



$('#content_url > input[@name="proficiency"]').click(function(){
$('#content_url > input[@name="proficiency"]').setValue($(this).attr("value"));
});

            
        
$('#submit_url').click(function() {
    
        for (j = 0; j < 4; j++) {
if (eval('document.content_url.proficiency[' + j + '].checked') == true) {
    var proficiency = eval('document.content_url.proficiency[' + j + '].value'); }}

    server.SubmitContentUrl(document.content_url.url.value, document.content_url.topic.value, proficiency, OnSubmitUrlSuccess);
    
    
});
    
    

});







</script>

	

<title>Plopquiz - URL Induction </title></head>

<body>
<h1> Build Quiz Items From Webpage </h1>
<form name="content_url" id="content_url" >
<br/>
url
<input type="text" name="url" class="url_name" value="url" />
<br/>
<br/>
topic
<input type="text" name="topic" class="topic_name" value="topic" /> 
<br/><br/>
Choose Proficiency and ProficiencyTopic
<I>(nested list -- jquery table?)</I>
<br/>
<input type="checkbox" id="1" name="proficiency" value="building_webapps" ><span>Building Web Apps</span><br/>
<input type="checkbox" id="2" name="proficiency" value="clean_energy" ><span>Clean Energy</span><br/>
<input type="checkbox" id="3" name="proficiency" value="collective_intelligence" ><span>Collective Intelligence</span><br/>
<input type="checkbox" id="4" name="proficiency" value="startup_financing" checked ><span>Startup Financing</span><br/>
<br/>
<br/>

<input type="submit" onClick="return false;this.disabled = true;" id="submit_url" class="submit_url" value="Submit URL" />


</form>




<div id="tags">

</div>

<div id="taglist">Tags: </div>
Tag this post: <!--<input type="text" id="suggestTag" /> -->

<div id="tagger">Aligator</div>
<script type="text/javascript">
jQuery(function($) {
	
	$('div#tagger').click(function(){
		console.log('click');
		$(this).attr('id', 'hulu');
		 var this_word = $(this).text()
		$(this).html('<input type="text" id="suggestTag"/>');
		$('#suggestTag').val(this_word);
		   $("#suggestTag").freebaseSuggest().bind(
		   "fb-select", function(e, data) { 
         $('#suggestTag').val(''); // clear the input
         $('#taglist').append('<a href="http://freebase.com/view'+ data.id +'">'+ data.name +'</a>');
         
         
    });
		
		
	}); 
	
	
    $('div#tagger').toggle(
      function () {
		console.log('click');
		 var this_word = $(this).text()
		$(this).html('<input type="text" id="suggestTag"/>');
		$('#suggestTag').val(this_word);
		   $("#suggestTag").freebaseSuggest().bind(
		   "fb-select", function(e, data) { 
         $('#suggestTag').val(''); // clear the input
         $('#taglist').append('<a href="http://freebase.com/view'+ data.id +'">'+ data.name +'</a>');
         
         
    });

	},
      function () {
        console.log('noo!');
      }
    );

	
	/* create input element with word as value, and then perform freebase suggest. */

 /* $('div#tagger').hover(function(){
   $(this)
      .freebaseSuggest()
      .bind("fb-select", function(e, data) { 
         //$('#suggestTag').val(''); // clear the input
         $('#taglist').append('<a href="http://freebase.com/view'+ data.id +'">'+ data.name +'</a>');
    }); 

}, function(){
console.log('no!');
}); */
    
    
    

});

</script>


<div class="quiz_items" id="quiz_items">

</div>


</body></html>
