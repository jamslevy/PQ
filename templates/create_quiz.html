<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<link rel="stylesheet" type="text/css" media="screen" href="/static/stylesheets/quizframe.css"/>-->
<script type="text/javascript" src="/static/scripts/jquery-1.2.6.min.js"></script>
<script type="text/javascript" src="/static/scripts/json2min.js"></script>


<script type="text/javascript">


$(document).ready(function() {
    



});


</script>


	

<title>Plopquiz - Create Quiz </title></head>

<body>
<div>
{% for quiz_item in raw_quiz_items %}

Quiz Item Text <br/>

<i>{{ quiz_item.paragraphs_containing_tag.0 }}</i>
{{ quiz_item.paragraphs_containing_tag.1 }}  <i>{{ quiz_item.paragraphs_containing_tag.2 }}</i>
<br/>

Answer Candidates: 
<br/>
{% for topic in quiz_item.similar_topics %}
<br/>
<div class="answer_candidate"><b>{{ topic }}</b></div>
{% endfor %}



<a id="submit_item" >Submit Quiz Item</a>





<script type="text/javascript">


$(document).ready(function() {
    
    
function Request(function_name, opt_argv) {

	if (!opt_argv)
		opt_argv = new Array();

	// Find if the last arg is a callback function; save it
	var callback = null;
	var len = opt_argv.length;

	if (len > 0 && typeof opt_argv[len-1] == 'function') {
		callback = opt_argv[len-1];
		opt_argv.length--;
	}

	var async = (callback != null);

	// Encode the arguments in to a URI
	var query = 'action=' + encodeURIComponent(function_name);

	for (var i = 0; i < opt_argv.length; i++) {
		var key = 'arg' + i;
		var val = JSON.stringify(opt_argv[i]);
		query += '&' + key + '=' + encodeURIComponent(val);
	}
	query += '&time=' + new Date().getTime(); // IE cache workaround

	// Create an XMLHttpRequest 'GET' request w/ an optional callback handler 
	var req = new XMLHttpRequest();
	req.open('GET', '/rpc?' + query, async);

	if (async) {
		req.onreadystatechange = function() {
			if(req.readyState == 4 && req.status == 200) {
				var response = null;
				try {
					response = JSON.parse(req.responseText);
				} catch (e) {
					response = req.responseText;
				}
				callback(response);
			}
		}
	}

	// Make the actual request
	req.send(null);
}

// Adds a stub function that will pass the arguments to the AJAX call 
function InstallFunction(obj, functionName) {
	obj[functionName] = function() { 
		Request(functionName, arguments);
	}
}


// Server object that will contain the callable methods
var server = {};
var item_count = 0;

InstallFunction(server, 'SubmitQuizItem');


function SubmitQuizItem(right_answer, wrong_answers, quiz_item_content) {
	server.SubmitQuizItem(right_answer, wrong_answers, quiz_item_content, onAddSuccess);
}


function onAddSuccess(response)
{
    console.log(response);
}


    
function PreviewAnswer(answer) {

 	var answer_span = $('.answer_span');
	$('.answer_candidate').hover(function()
	
	{
	      
        answer_span.fadeTo(1,0.5);
        answer_span.html("&nbsp;" + $(this).text() + "&nbsp;");
	    answer_span.fadeTo("slow", 1);
  
		
			
			
	},
	function()
	{
	    
		answer_span.empty();
		answer_span.html(answer);
        answer_span.fadeTo(100, 0.5);
	});   
    
    
}


PreviewAnswer("{{quiz_item.correct_answer}}");


$('a#submit_item').click(function() {
    SubmitQuizItem("{{quiz_item.correct_answer}}", "wrong answers", "edited quiz item content");
});
    
    

});



</script>


{% endfor %}


</div>


</body></html>
